<!-- @cmp-manifest
{
  "schema": "cmp-manifest/v1",
  "id": "chem.labware.crucible.basic",
  "name": "坩埚",
  "nameEn": "Crucible",
  "category": "chemistry/labware",
  "version": "1.0.0",
  "viewport": { "w": 100, "h": 120 },
  "tags": ["chemistry", "labware", "crucible", "porcelain", "heating", "high-temperature"],
  "props": [
    { "key": "size",       "type": "number(px)", "default": 120, "min": 60, "max": 300, "desc": "组件高度" },
    { "key": "bodyColor",  "type": "color",  "default": "#e0e0e0", "desc": "瓷体颜色" },
    { "key": "innerColor", "type": "color",  "default": "#f5f5f5", "desc": "内壁颜色" },
    { "key": "stroke",     "type": "color",  "default": "#616161", "desc": "描边颜色" },
    { "key": "strokeWidth","type": "number", "default": 1.2, "min": 0.5, "max": 3, "desc": "描边粗细" },
    { "key": "showLid",    "type": "boolean", "default": true, "desc": "显示坩埚盖" },
    { "key": "glow",       "type": "number(0-1)", "default": 0, "min": 0, "max": 1, "desc": "亮度" }
  ],
  "cssVars": {
    "size":       "--cmp-size",
    "bodyColor":  "--cmp-body",
    "innerColor": "--cmp-inner",
    "stroke":     "--cmp-stroke",
    "strokeWidth":"--cmp-stroke-width",
    "glow":       "--cmp-glow"
  }
}
-->
<div class="cmp" data-cmp-id="chem.labware.crucible.basic" role="img" aria-label="坩埚">
  <style>
    .cmp[data-cmp-id="chem.labware.crucible.basic"] {
      --h: var(--cmp-size, 120px);
      display: inline-block;
      width: calc(var(--h) * 100 / 120);
      height: var(--h);
      filter: drop-shadow(0 0 calc(6px * var(--cmp-glow, 0))
              rgba(255,214,102, calc(0.8 * var(--cmp-glow, 0))));
      user-select: none;
    }
    .cmp[data-cmp-id="chem.labware.crucible.basic"] svg {
      width: 100%; height: 100%; display: block; overflow: visible;
    }
  </style>

  <svg viewBox="0 0 100 120" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
    <defs>
      <!-- 坩埚体渐变 -->
      <linearGradient class="cr__body-grad" x1="0.2" y1="0" x2="0.8" y2="1">
        <stop offset="0" stop-color="var(--cmp-body, #e0e0e0)"/>
        <stop offset="0.3" stop-color="var(--cmp-body, #e0e0e0)" stop-opacity="0.95"/>
        <stop offset="0.7" stop-color="#bdbdbd"/>
        <stop offset="1" stop-color="#9e9e9e" stop-opacity="0.85"/>
      </linearGradient>
      <!-- 内壁渐变 -->
      <radialGradient class="cr__inner-grad" cx="0.5" cy="0.55" r="0.5">
        <stop offset="0" stop-color="#bdbdbd" stop-opacity="0.4"/>
        <stop offset="0.5" stop-color="var(--cmp-inner, #f5f5f5)" stop-opacity="0.8"/>
        <stop offset="1" stop-color="var(--cmp-inner, #f5f5f5)"/>
      </radialGradient>
      <!-- 盖子渐变 -->
      <linearGradient class="cr__lid-grad" x1="0.3" y1="0" x2="0.7" y2="1">
        <stop offset="0" stop-color="#f5f5f5"/>
        <stop offset="0.4" stop-color="var(--cmp-body, #e0e0e0)"/>
        <stop offset="1" stop-color="#bdbdbd" stop-opacity="0.9"/>
      </linearGradient>
    </defs>

    <!--
      坩埚结构（viewBox 100×120）：
      坩埚口椭圆中心 (50, 52)，rx=32 ry=10
      坩埚底弧线最低点 y≈105
      盖子斜放在右上方
    -->

    <!-- ===== 底部投影 ===== -->
    <ellipse cx="50" cy="112" rx="22" ry="5" fill="#000" opacity="0.07"/>

    <!-- ===== 坩埚体 ===== -->
    <!-- 外壁（梯形弧线，上宽下窄） -->
    <path class="cr__body"
          d="M18,52 Q16,80 28,100 Q38,110 50,110 Q62,110 72,100 Q84,80 82,52
             A32,10 0 0,0 18,52 Z"
          stroke="var(--cmp-stroke, #616161)" stroke-width="var(--cmp-stroke-width, 1.2)"
          stroke-linejoin="round"/>

    <!-- 外壁瓷釉纹理 -->
    <path d="M22,65 Q50,70 78,65" fill="none"
          stroke="#bdbdbd" stroke-width="0.4" opacity="0.35"/>
    <path d="M26,78 Q50,83 74,78" fill="none"
          stroke="#bdbdbd" stroke-width="0.4" opacity="0.3"/>
    <path d="M32,90 Q50,94 68,90" fill="none"
          stroke="#bdbdbd" stroke-width="0.3" opacity="0.25"/>

    <!-- 外壁左侧高光 -->
    <path d="M22,56 Q20,72 30,95" fill="none"
          stroke="#fff" stroke-width="2" opacity="0.12" stroke-linecap="round"/>
    <path d="M26,56 Q24,70 32,90" fill="none"
          stroke="#fff" stroke-width="0.8" opacity="0.08" stroke-linecap="round"/>

    <!-- 外壁右侧暗面 -->
    <path d="M76,58 Q80,74 70,96" fill="none"
          stroke="#000" stroke-width="1" opacity="0.05" stroke-linecap="round"/>

    <!-- ===== 坩埚口 ===== -->
    <!-- 口沿厚度环 -->
    <path class="cr__rim"
          d="M18,52 A32,10 0 0,1 82,52 A32,10 0 0,1 18,52 Z
             M22,52 A28,8 0 0,0 78,52 A28,8 0 0,0 22,52 Z"
          fill="var(--cmp-body, #e0e0e0)" fill-rule="evenodd"
          stroke="none"/>
    <!-- 外椭圆描边 -->
    <ellipse cx="50" cy="52" rx="32" ry="10" fill="none"
             stroke="var(--cmp-stroke, #616161)" stroke-width="var(--cmp-stroke-width, 1.2)"/>
    <!-- 内椭圆描边 -->
    <ellipse cx="50" cy="52" rx="28" ry="8" fill="none"
             stroke="var(--cmp-stroke, #616161)" stroke-width="0.5" opacity="0.4"/>
    <!-- 口沿高光 -->
    <path d="M30,44 Q45,40 68,44" fill="none"
          stroke="#fff" stroke-width="1.2" opacity="0.25" stroke-linecap="round"/>

    <!-- ===== 内壁 ===== -->
    <ellipse class="cr__inner" cx="50" cy="53" rx="26" ry="7"
             stroke="none"/>
    <!-- 内壁深度阴影 -->
    <ellipse cx="50" cy="56" rx="18" ry="4" fill="#000" opacity="0.04"/>

    <!-- ===== 坩埚盖（斜放在右上方） ===== -->
    <g class="cr__lid-group">
      <!-- 盖子主体（椭圆碟形，略微倾斜） -->
      <g transform="translate(72,28) rotate(15)">
        <!-- 盖面 -->
        <ellipse class="cr__lid" cx="0" cy="0" rx="20" ry="8"
                 stroke="var(--cmp-stroke, #616161)" stroke-width="var(--cmp-stroke-width, 1.2)"/>
        <!-- 盖子厚度 -->
        <path d="M-20,0 Q-20,4 0,5 Q20,4 20,0"
              fill="var(--cmp-body, #e0e0e0)" opacity="0.6"
              stroke="var(--cmp-stroke, #616161)" stroke-width="0.5"/>
        <!-- 盖顶把手 -->
        <ellipse cx="0" cy="-1" rx="5" ry="2.5"
                 fill="var(--cmp-body, #e0e0e0)"
                 stroke="var(--cmp-stroke, #616161)" stroke-width="0.8"/>
        <ellipse cx="-1" cy="-2" rx="2" ry="1" fill="#fff" opacity="0.15"/>
        <!-- 盖面高光 -->
        <path d="M-12,-4 Q-2,-7 10,-4" fill="none"
              stroke="#fff" stroke-width="0.8" opacity="0.2" stroke-linecap="round"/>
      </g>
    </g>
  </svg>
</div>

<script>
(function() {
  var script = document.currentScript;
  if (!script) return;
  var root = script.previousElementSibling;
  if (!root || root.getAttribute('data-cmp-id') !== 'chem.labware.crucible.basic') return;
  var svg = root.querySelector('svg');
  if (!svg) return;

  /* ── 唯一 ID ── */
  var uid = 'cr_' + Math.random().toString(36).slice(2, 8);

  var bodyGrad = svg.querySelector('.cr__body-grad');
  var innerGrad = svg.querySelector('.cr__inner-grad');
  var lidGrad = svg.querySelector('.cr__lid-grad');
  if (bodyGrad) bodyGrad.setAttribute('id', uid + '_bg');
  if (innerGrad) innerGrad.setAttribute('id', uid + '_ig');
  if (lidGrad) lidGrad.setAttribute('id', uid + '_lg');

  /* 填色绑定 */
  var body = root.querySelector('.cr__body');
  var inner = root.querySelector('.cr__inner');
  var lid = root.querySelector('.cr__lid');
  if (body) body.setAttribute('fill', 'url(#' + uid + '_bg)');
  if (inner) inner.setAttribute('fill', 'url(#' + uid + '_ig)');
  if (lid) lid.setAttribute('fill', 'url(#' + uid + '_lg)');

  /* ── Props ── */
  var P = {};
  try {
    var raw = root.getAttribute('data-props');
    if (raw) { var o = JSON.parse(raw); if (o && typeof o === 'object') P = o; }
  } catch(e) {}

  /* showLid */
  var lidGroup = root.querySelector('.cr__lid-group');
  if (lidGroup && (P.showLid === false || P.showLid === 'false')) {
    lidGroup.setAttribute('display', 'none');
  }
})();
</script>